!function(t,e,i,o){"use strict";function a(t){return t.startOf("hour"),t}function s(t){var e=a(moment());return e.add(t,"hours"),e}function r(t,e){var i=a(moment());return t===o?(a(e),t=e.diff(i,"hours")):(e=i,e.add(t,"hours")),{m:e,value:t}}var n=1e3;e.TimeSlider=function(i,o,a){function s(e,i,o){e[i]=e[i]||{};for(var a=0;a<o.length;a++){var s=o[a];"string"===t.type(e[i][s])&&(e[i][s]=t(e[i][s]))}}o=t.extend({grid:!0,gridDistances:[1,2,3,6,12,24,48]},o),this.dateTimeFormat=new e.DateTimeFormat,o.display=o.display||{},s(o.display,"from",["tzElement","utcElement","relativeElement"]),s(o.display,"to",["tzElement","utcElement","relativeElement"]),o.text=t.extend({hourAbbr:"h",minAbbr:"m",now:"now",to:"to"},o.text),o.text.nowUC=o.text.now.charAt(0).toUpperCase()+o.text.now.slice(1),o.values_separator=" "+o.text.to+" ";var n=r(o.min,o.minMoment);o.min=n.value,o.minMoment=n.m,n=r(o.max,o.maxMoment),o.max=n.value,o.maxMoment=n.m,e.BaseSlider.call(this,i,o,a),this.setFromValue(r(o.from,o.fromMoment).value),o.isInterval&&this.setToValue(r(o.to,o.toMoment).value),this.setFormat({},!0)},t.fn.timeSlider=function(i){return this.each(function(){t.data(this,"timeSlider")||t.data(this,"timeSlider",new e.TimeSlider(this,i,n++))})},e.TimeSlider.prototype={_valueToTzMoment:function(t,e){return this.dateTimeFormat.tzMoment(s(t),e)},_valueToFormat:function(t,e){return e?this._valueToTzMoment(t,e).format(this.options.display.formatStr):this.options.text.nowUC+(t>=0?" + ":" - ")+Math.abs(t)+this.options.text.hourAbbr},hhFormat:function(t){return t.format("24"==this.options.format.time?"HH":"hha")},_prettify_relative:function(t){return this._valueToFormat(t)},_prettify_text_relative:function(t){return t},_prettify_absolute:function(t){return this._valueToFormat(t,this.options.format.timezone)},_prettify_text_absolute:function(t){var e=this._valueToTzMoment(t,this.options.format.timezone);return this.hhFormat(e)},_prettify_text_absolute_date:function(t){return this._valueToTzMoment(t,this.options.format.timezone).format(this.options.format.dateFormat)},adjustResult:function(){this.result.minMoment=s(this.result.min),this.result.maxMoment=s(this.result.max),this.result.fromMoment=s(this.result.from),this.result.toMoment=s(this.result.to)},appendDateGrid:function(t,e){var i,o,a,s,r,n=this.options,m=0,h=n.stepPx/n.step,d=0,p=!0,f=0,u=0,l=[];for(this._setDateTimeFormat(),this.appendGridContainer(),this.calcGridMargin(),this.currentGridContainer.addClass("text-between-ticks"),this._prettify_text=this._prettify_text_absolute_date,i=n.min;i<=n.max;)(i-this.options.major_ticks_offset)%n.tickDistanceNum===0&&0===this._valueToTzMoment(i,this.options.format.timezone).hour()&&(d++,this.appendTick(m,e),p&&(p=!1,f=i),u=i),i+=n.step,m+=n.stepP;if(o=h*(0===d?n.max-n.min:1==d?Math.max(f-n.min,n.max-f):24)-6,!n.format.dateFormat){switch(this.dateTimeFormat.options.date){case"DMY":a=["ddd, DD. MMM YYYY","ddd, DD. MMM YY","DD. MMM YYYY","DD. MMM YY","DD/MM/YYYY","DD/MM/YY","DD/MM","DD"];break;case"MDY":a=["ddd, MMM DD, YYYY","ddd, MMM DD, YY","MMM DD, YYYY","MMM DD, YY","MM/DD/YYYY","MM/DD/YY","MM/DD","DD"];break;case"YMD":a=["ddd, YYYY MMM DD","ddd, YY MMM DD","YYYY MMM DD","YY MMM DD","YYYY/MM/DD","YY/MM/DD","MM/DD","DD"]}for(i=n.min;i<=n.max;)l.push(i),i+=24;for(var M=0;M<a.length;M++){n.format.dateFormat=a[M],s=!0;for(var _=0;_<l.length;_++)if(this.getTextWidth(l[_],t)>o){s=!1;break}if(s)break}s||(n.format.dateFormat="")}if(n.format.dateFormat)if(0===d)this.appendText(n.stepP*((n.max-n.min)/2),n.min,t);else{if(r=this.getTextWidth(n.min,t),h*(f-n.min)>=r){var c=n.min+r/2/h;this.appendText(n.stepP*(Math.max(c,f-12)-n.min),n.min,t)}if(r=this.getTextWidth(n.max,t),h*(n.max-u)>=r){var D=n.max-r/2/h;this.appendText(n.stepP*(Math.min(D,u+12)-n.min),n.max,t)}if(d>1)for(i=f+12;u>=i;)this.appendText(n.stepP*(i-n.min),i,t),i+=24}},appendStandardGrid:function(){if(this.$cache.grid=this.$cache.cont.find(".grid").first(),this.$cache.grid.siblings(".grid").remove(),this.$cache.grid.empty(),this.currentGridContainer=null,this.options.format.showRelative)this._prettify=this._prettify_relative,this._prettify_text=this._prettify_text_relative,this.options.major_ticks_offset=0,this._appendStandardGrid();else{var t=moment();if(this._prettify=this._prettify_absolute,this._prettify_text=this._prettify_text_absolute,this.options.major_ticks_offset=-1*this.dateTimeFormat.tzMoment(t,this.options.format.timezone).hours(),this._appendStandardGrid(),this.appendDateGrid(),"utc"!=this.options.format.timezone&&this.options.format.showUTC){this.options.major_ticks_offset=-1*this.dateTimeFormat.tzMoment(t,"utc").hours();var e=this.options.format.timezone;this.options.format.timezone="utc";var i={italic:!0,minor:!0},o={color:"#555555"};this._prettify=this._prettify_absolute,this._prettify_text=this._prettify_text_absolute,this._appendStandardGrid(i,o),this.appendDateGrid(i,o),this.options.format.timezone=e}}},_setDateTimeFormat:function(){this.dateTimeFormat.setFormat({date:this.options.format.date,time:this.options.format.time,timezoneId:this.options.format.timezone})},setFormat:function(e){this.options.format=t.extend({date:"DMY",time:"24",showRelative:!1,timezone:"utc",showUTC:!1},this.options.format,e),this._setDateTimeFormat(),this.options.display.formatStr=("DMY"!=this.dateTimeFormat.options.date?"MMM-DD":"DD-MMM")+" "+this.dateTimeFormat.timeFormat,this.options.format.dateFormat="",this.update(),this.updateDisplay()},updateDisplay:function(){function e(e,i){e&&e.each(function(){t(this).text(i)})}var i,o,a;for(i=0;2>i;i++)a=i?this.result.to:this.result.from,o=i?this.options.display.to:this.options.display.from,e(o.tzElement,this._valueToFormat(a,this.options.format.timezone)),e(o.utcElement,this._valueToFormat(a,"utc")),e(o.relativeElement,this._valueToFormat(a))},preCallback:function(){this.updateDisplay()}},e.TimeSlider.prototype=t.extend({},e.BaseSlider.prototype,e.TimeSlider.prototype)}(jQuery,this,document);