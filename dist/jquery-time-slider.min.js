!function(a,b,c,d){"use strict";function e(a){return a.startOf("hour"),a}function f(a){var b=e(moment());return b.add(a,"hours"),b}function g(a,b){var c=e(moment());return a===d?(e(b),a=b.diff(c,"hours")):(b=c,b.add(a,"hours")),{m:b,value:a}}var h=1e3;b.TimeSlider=function(c,e,f){function h(b,c,d){b[c]=b[c]||{};for(var e=0;e<d.length;e++){var f=d[e];"string"===a.type(b[c][f])&&(b[c][f]=a(b[c][f]))}}this.VERSION="{VERSION}",e=a.extend({grid:!0,gridDistances:[1,2,3,6,12,24,48],step_offset_moment:null},e),this.dateTimeFormat=new b.DateTimeFormat,e.display=e.display||{},h(e.display,"from",["tzElement","utcElement","relativeElement"]),h(e.display,"to",["tzElement","utcElement","relativeElement"]),e.text=a.extend({hourAbbr:"h",minAbbr:"m",now:"now",to:"to"},e.text),e.text.nowUC=e.text.now.charAt(0).toUpperCase()+e.text.now.slice(1),e.values_separator=" "+e.text.to+" ";var i=g(e.min,e.minMoment);if(e.min=i.value,e.minMoment=i.m,i=g(e.max,e.maxMoment),e.max=i.value,e.maxMoment=i.m,e.step>1&&e.step_offset_moment){var j=g(d,moment(e.step_offset_moment)).value;e.step_offset=(j-e.min)%e.step}b.BaseSlider.call(this,c,e,f),this.setFromValue(g(e.from,e.fromMoment).value),e.isInterval&&this.setToValue(g(e.to,e.toMoment).value),this.setFormat({},!0)},a.fn.timeSlider=function(c){return this.each(function(){a.data(this,"timeSlider")||a.data(this,"timeSlider",new b.TimeSlider(this,c,h++))})},b.TimeSlider.prototype={_valueToTzMoment:function(a,b){return this.dateTimeFormat.tzMoment(f(a),b)},_valueToFormat:function(a,b){return b?this._valueToTzMoment(a,b).format(this.options.display.formatStr):this.options.text.nowUC+(a>=0?" + ":" - ")+Math.abs(a)+this.options.text.hourAbbr},hhFormat:function(a){return a.format("24"==this.options.format.time?"HH":"hha")},_prettify_relative:function(a){return this._valueToFormat(a)},_prettify_text_relative:function(a){return a},_prettify_absolute:function(a){return this._valueToFormat(a,this.options.format.timezone)},_prettify_text_absolute:function(a){var b=this._valueToTzMoment(a,this.options.format.timezone);return this.hhFormat(b)},_prettify_text_absolute_date:function(a){return this._valueToTzMoment(a,this.options.format.timezone).format(this.options.format.dateFormat)},adjustResult:function(){this.result.minMoment=f(this.result.min),this.result.maxMoment=f(this.result.max),this.result.fromMoment=f(this.result.from),this.result.toMoment=f(this.result.to)},appendDateGrid:function(a,b){var c,d,e,f,g,h=this.options,i=0,j=h.stepPx/h.step,k=0,l=!0,m=0,n=0,o=[];for(this._setDateTimeFormat(),this.appendGridContainer(),this.calcGridMargin(),this.currentGridContainer.addClass("text-between-ticks"),this._prettify_text=this._prettify_text_absolute_date,c=h.min;c<=h.max;)(c-this.options.major_ticks_offset)%h.tickDistanceNum===0&&0===this._valueToTzMoment(c,this.options.format.timezone).hour()&&(k++,this.appendTick(i,b),l&&(l=!1,m=c),n=c),c+=1,i+=h.oneP;if(d=j*(0===k?h.max-h.min:1==k?Math.max(m-h.min,h.max-m):24)-6,!h.format.dateFormat){switch(this.dateTimeFormat.options.date){case"DMY":e=["ddd, DD. MMM YYYY","ddd, DD. MMM YY","DD. MMM YYYY","DD. MMM YY","DD/MM/YYYY","DD/MM/YY","DD/MM","DD"];break;case"MDY":e=["ddd, MMM DD, YYYY","ddd, MMM DD, YY","MMM DD, YYYY","MMM DD, YY","MM/DD/YYYY","MM/DD/YY","MM/DD","DD"];break;case"YMD":e=["ddd, YYYY MMM DD","ddd, YY MMM DD","YYYY MMM DD","YY MMM DD","YYYY/MM/DD","YY/MM/DD","MM/DD","DD"]}for(c=h.min;c<=h.max;)o.push(c),c+=24;for(var p=0;p<e.length;p++){h.format.dateFormat=e[p],f=!0;for(var q=0;q<o.length;q++)if(this.getTextWidth(o[q],a)>d){f=!1;break}if(f)break}f||(h.format.dateFormat="")}if(h.format.dateFormat)if(0===k)this.appendText(h.oneP*((h.max-h.min)/2),h.min,a);else{if(g=this.getTextWidth(h.min,a),j*(m-h.min)>=g){var r=h.min+g/2/j;this.appendText(h.oneP*(Math.max(r,m-12)-h.min),h.min,a)}if(g=this.getTextWidth(h.max,a),j*(h.max-n)>=g){var s=h.max-g/2/j;this.appendText(h.oneP*(Math.min(s,n+12)-h.min),h.max,a)}if(k>1)for(c=m+12;n>=c;)this.appendText(h.oneP*(c-h.min),c,a),c+=24}},appendStandardGrid:function(){if(this.$cache.grid=this.$cache.cont.find(".grid").first(),this.$cache.grid.siblings(".grid").remove(),this.$cache.grid.empty(),this.currentGridContainer=null,this.options.format.showRelative)this._prettify=this._prettify_relative,this._prettify_text=this._prettify_text_relative,this.options.major_ticks_offset=0,this._appendStandardGrid();else{var a=moment();if(this._prettify=this._prettify_absolute,this._prettify_text=this._prettify_text_absolute,this.options.major_ticks_offset=-1*this.dateTimeFormat.tzMoment(a,this.options.format.timezone).hours(),this._appendStandardGrid(),this.appendDateGrid(),"utc"!=this.options.format.timezone&&this.options.format.showUTC){this.options.major_ticks_offset=-1*this.dateTimeFormat.tzMoment(a,"utc").hours();var b=this.options.format.timezone;this.options.format.timezone="utc";var c={italic:!0,minor:!0},d={color:"#555555"};this._prettify=this._prettify_absolute,this._prettify_text=this._prettify_text_absolute,this._appendStandardGrid(c,d),this.appendDateGrid(c,d),this.options.format.timezone=b}}},_setDateTimeFormat:function(){this.dateTimeFormat.setFormat({date:this.options.format.date,time:this.options.format.time,timezoneId:this.options.format.timezone})},setFormat:function(b){this.options.format=a.extend({date:"DMY",time:"24",showRelative:!1,timezone:"utc",showUTC:!1},this.options.format,b),this._setDateTimeFormat(),this.options.display.formatStr=("DMY"!=this.dateTimeFormat.options.date?"MMM-DD":"DD-MMM")+" "+this.dateTimeFormat.timeFormat,this.options.format.dateFormat="",this.update(),this.updateDisplay()},updateDisplay:function(){function b(b,c){b&&b.each(function(){a(this).text(c)})}var c,d,e;for(c=0;2>c;c++)e=c?this.result.to:this.result.from,d=c?this.options.display.to:this.options.display.from,b(d.tzElement,this._valueToFormat(e,this.options.format.timezone)),b(d.utcElement,this._valueToFormat(e,"utc")),b(d.relativeElement,this._valueToFormat(e))},preCallback:function(){this.updateDisplay()}},b.TimeSlider.prototype=a.extend({},b.BaseSlider.prototype,b.TimeSlider.prototype)}(jQuery,this,document);